<div class="d-flex justify-content-between align-items-center mb-4">
    <h1>Órdenes de Compra</h1>
    <div>
        <a href="/admin/ordenes-compra/nueva" class="btn btn-primary me-2"><i class="bi bi-plus-circle me-2"></i>Crear Nueva Orden</a>
        <a href="/dashboard" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> Volver al Dashboard</a>
    </div>
</div>

<div class="card admin-card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-dark table-hover align-middle">
                <thead>
                    <tr>
                        <th>ID Orden</th>
                        <th>Proveedor</th>
                        <th>Fecha Creación</th>
                        <th class="text-end">Total Estimado</th>
                        <th class="text-center">Estado</th>
                    </tr>
                </thead>
                <tbody>
                    {{#each ordenes}}
                    <tr style="cursor: pointer;" onclick="window.location='/admin/ordenes-compra/detalle/{{this.id_orden}}'">
                        <td>#{{this.id_orden}}</td>
                        <td>{{this.proveedor_nombre}}</td>
                        <td>{{#with (lookup (split (lookup this 'fecha_creacion') 'T') 0)}}{{this}}{{/with}}</td>
                        <td class="text-end" style="color: var(--color-primary);">${{this.total_estimado}}</td>
                        <td class="text-center">
                            {{#if (eq this.estado 'Pendiente')}}<span class="badge bg-warning text-dark">Pendiente</span>{{/if}}
                            {{#if (eq this.estado 'Enviada')}}<span class="badge bg-info text-dark">Enviada</span>{{/if}}
                            {{#if (eq this.estado 'Recibida')}}<span class="badge bg-success">Recibida</span>{{/if}}
                            {{#if (eq this.estado 'Cancelada')}}<span class="badge bg-danger">Cancelada</span>{{/if}}
                        </td>
                    </tr>
                    {{else}}
                    <tr>
                        <td colspan="5" class="text-center p-4">
                            <p class="mb-2">No se han creado órdenes de compra todavía.</p>
                            <a href="/admin/ordenes-compra/nueva" class="btn btn-primary">Crear la primera orden</a>
                        </td>
                    </tr>
                    {{/each}}
                </tbody>
            </table>
        </div>
    </div>
</div>